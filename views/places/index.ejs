<% layout('layouts/boilerplate') %>
<div id='cluster-map' class='mb-4'></div>
<h1 class='mb-4'>View Places</h1>
<ul>
    <% for (let place of places) { %>
        <div class='card mb-2'>
            <div class='row'>
                <div class='col-md-4'>
                    <img class='img-fluid' src='<%= place.images[0].url %>' alt=''>
                </div>
                <div class='col-md-8'>
                    <div class='card-body'>
                        <h5 class='card-title'><%= place.title %></h5>
                        <p class='card-text'><%= place.description %></p>
                        <p class='card-text'>Price: $<%= place.price %></p>
                        <p class='card-text'>
                            <small class='text-muted'><%= place.address %></small>
                        </p>
                        <a class='btn btn-primary' href='/places/<%= place._id %>'>View <%= place.title %></a>
                    </div>
                </div>
            </div>
        </div>
    <% } %>
</ul>

<script>
    const mapBoxToken = '<%- process.env.MAPBOX_TOKEN %>';
    const places = {features: <%- JSON.stringify(places) %>};
</script>
<script src='/js/clusterMap.js'></script>